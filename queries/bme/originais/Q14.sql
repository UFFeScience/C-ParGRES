PASSO 1:

SELECT CD2010ADOMI.CODUFCENSO GEOGRAFIA_COD , 9032 GEOGRAFIA_DIM_COD , 'Unidade da Federação' GEOGRAFIA_DIM_DESC , CD2010ADOMI.CODANOPESQ TEMPO_COD , 8030 TEMPO_DIM_COD , NVL(CD2010APESS.CODV0617, -1) COL1 , NVL(CD2010APESS.CODV0615, -1) COL2 , NVL(CD2010ADOMI.CODV1006, -1) COL3 , NVL(CD2010ADOMI.CODV4002, -1) COL4 , SUM(CD2010APESS.PESOPESS) frequencia , count(*) contagem FROM IBGE.CD2010APESS , IBGE.CD2010ADOMI WHERE CD2010ADOMI.CODUFCENSO in (select Codigo from G032 where IND_EXIBICAO = 'S' ) AND ((CD2010APESS.CODV0617 = '1') OR (CD2010APESS.CODV0615 = '1' OR CD2010APESS.CODV0615 = '2' OR CD2010APESS.CODV0615 = '3')) AND (CD2010ADOMI.CODV4002 = '11' OR CD2010ADOMI.CODV4002 = '12' OR CD2010ADOMI.CODV4002 = '13' OR CD2010ADOMI.CODV4002 = '14' OR CD2010ADOMI.CODV4002 = '15' OR CD2010ADOMI.CODV4002 = '51' OR CD2010ADOMI.CODV4002 = '52' OR CD2010ADOMI.CODV4002 = '53' OR CD2010ADOMI.CODV4002 = '61' OR CD2010ADOMI.CODV4002 = '62' OR CD2010ADOMI.CODV4002 = '63' OR CD2010ADOMI.CODV4002 = '64' OR CD2010ADOMI.CODV4002 = '65' OR CD2010ADOMI.CODV4002 = '71' OR CD2010ADOMI.CODV4002 = '72' OR CD2010ADOMI.CODV4002 = '73' OR CD2010ADOMI.CODV4002 = '74') AND (CD2010APESS.V0006 = CD2010ADOMI.V0006 AND CD2010APESS.V0007 = CD2010ADOMI.V0007 AND CD2010APESS.CODSETOR = CD2010ADOMI.CODSETOR) GROUP BY CD2010ADOMI.CODUFCENSO , CD2010ADOMI.CODANOPESQ , NVL(CD2010APESS.CODV0617, -1) , NVL(CD2010APESS.CODV0615, -1) , NVL(CD2010ADOMI.CODV1006, -1) , NVL(CD2010ADOMI.CODV4002, -1)

PASSO 2:

SELECT BMM_TMP_873891.GEOGRAFIA_COD , BMM_TMP_873891.GEOGRAFIA_DIM_COD , BMM_TMP_873891.GEOGRAFIA_DIM_DESC , G032.Denominacao geografia_desc , BMM_TMP_873891.TEMPO_COD , BMM_TMP_873891.TEMPO_DIM_COD , T030.Denominacao tempo_desc , tab1.Denominacao COL1 , tab1.Ordem COL1_ord , tab1.Codigo COL1_cod , tab2.Denominacao COL2 , tab2.Ordem COL2_ord , tab2.Codigo COL2_cod , tab3.Denominacao COL3 , tab3.Ordem COL3_ord , tab3.Codigo COL3_cod , tab4.Denominacao COL4 , tab4.Ordem COL4_ord , tab4.Codigo COL4_cod , BMM_TMP_873891.FREQUENCIA , BMM_TMP_873891.CONTAGEM FROM G032 , T030 , CD281800 tab1 , CD281500 tab2 , CD275000 tab3 , CD275300 tab4 , BMM_TMP_873891 WHERE BMM_TMP_873891.GEOGRAFIA_DIM_COD = 9032 AND (BMM_TMP_873891.TEMPO_COD = '2010') AND BMM_TMP_873891.TEMPO_DIM_COD = 8030 AND BMM_TMP_873891.COL1 = tab1.Codigo AND BMM_TMP_873891.COL2 = tab2.Codigo AND BMM_TMP_873891.COL3 = tab3.Codigo AND BMM_TMP_873891.COL4 = tab4.Codigo AND BMM_TMP_873891.TEMPO_COD = T030.Codigo AND BMM_TMP_873891.GEOGRAFIA_COD = G032.Codigo
PASSO 1:

SELECT 76 GEOGRAFIA_COD , 9000 GEOGRAFIA_DIM_COD , 'Pa√≠s' GEOGRAFIA_DIM_DESC , CD2010APESS.CODANOPESQ TEMPO_COD , 8030 TEMPO_DIM_COD , SUM(CD2010APESS.V6036 * CD2010APESS.PESOPESS) / SUM(CD2010APESS.PESOPESS) COL1 , SUM(CD2010APESS.PESOPESS) frequencia , count(*) contagem FROM IBGE.CD2010APESS WHERE (CD2010APESS.V6036 BETWEEN 20 AND 40) GROUP BY 76 , CD2010APESS.CODANOPESQ

PASSO 2:

SELECT BMM_TMP_872971.GEOGRAFIA_COD , BMM_TMP_872971.GEOGRAFIA_DIM_COD , BMM_TMP_872971.GEOGRAFIA_DIM_DESC , G000.Denominacao geografia_desc , BMM_TMP_872971.TEMPO_COD , BMM_TMP_872971.TEMPO_DIM_COD , T030.Denominacao tempo_desc , BMM_TMP_872971.COL1 , BMM_TMP_872971.FREQUENCIA , BMM_TMP_872971.CONTAGEM FROM G000 , T030 , BMM_TMP_872971 WHERE BMM_TMP_872971.GEOGRAFIA_DIM_COD = 9000 AND (BMM_TMP_872971.TEMPO_COD = '2010') AND BMM_TMP_872971.TEMPO_DIM_COD = 8030 AND BMM_TMP_872971.TEMPO_COD = T030.Codigo
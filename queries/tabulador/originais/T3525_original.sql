CREATE TABLE RT_CD2010_T3525_12230b AS (
 SELECT  CASE WHEN CD2010ADOMI.CODV1006 IN (-1, 1, 2) THEN 9999 ELSE -1 END AS INDICADORA_A00, 
 CASE WHEN CD2010ADOMI.CODV1006 = 1 THEN 1 WHEN CD2010ADOMI.CODV1006 = 2 THEN 2 ELSE -1 END AS INDICADORA_A01, 
 CASE WHEN CD2010ADOMI.CODV0202 IN (-1, 1, 2, 3, 4, 5, 6, 7, 8, 9) THEN 9999 ELSE -1 END AS INDICADORA_B00, 
 CASE WHEN CD2010ADOMI.CODV0202 = 1 THEN 1 WHEN CD2010ADOMI.CODV0202 = 2 THEN 2 WHEN CD2010ADOMI.CODV0202 = 3 THEN 3 WHEN CD2010ADOMI.CODV0202 = 4 THEN 4 WHEN CD2010ADOMI.CODV0202 = 5 THEN 5 WHEN CD2010ADOMI.CODV0202 = 6 THEN 6 WHEN CD2010ADOMI.CODV0202 = 7 THEN 7 WHEN CD2010ADOMI.CODV0202 = 8 THEN 8 WHEN CD2010ADOMI.CODV0202 = 9 THEN 9 ELSE -1 END AS INDICADORA_B01, 
 CASE WHEN CD2010ADOMI.CODV0203 IN (-1, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11) THEN 9999 ELSE -1 END AS INDICADORA_C00, 
 CASE WHEN CD2010ADOMI.CODV0203 = 1 THEN 1 WHEN CD2010ADOMI.CODV0203 = 2 THEN 2 WHEN CD2010ADOMI.CODV0203 = 3 THEN 3 WHEN CD2010ADOMI.CODV0203 = 4 THEN 4 WHEN CD2010ADOMI.CODV0203 = 5 THEN 5 WHEN CD2010ADOMI.CODV0203 = 6 THEN 6 WHEN CD2010ADOMI.CODV0203 = 7 THEN 7 WHEN CD2010ADOMI.CODV0203 = 8 THEN 8 WHEN CD2010ADOMI.CODV0203 = 9 THEN 9 WHEN CD2010ADOMI.CODV0203 IN (10, 11) THEN 10 ELSE -1 END AS INDICADORA_C01, 
 CASE WHEN CD2010ADOMI.CODV0204 IN (-1, 1, 2, 3, 4, 5, 6, 7, 8, 9) THEN 9999 ELSE -1 END AS INDICADORA_D00, 
 CASE WHEN CD2010ADOMI.CODV0204 = 1 THEN 1 WHEN CD2010ADOMI.CODV0204 = 2 THEN 2 WHEN CD2010ADOMI.CODV0204 = 3 THEN 3 WHEN CD2010ADOMI.CODV0204 = 4 THEN 4 WHEN CD2010ADOMI.CODV0204 = 5 THEN 5 WHEN CD2010ADOMI.CODV0204 IN (6, 7, 8, 9) THEN 6 ELSE -1 END AS INDICADORA_D01, 
 CASE WHEN CD2010ADOMI.CODV0209 IN (-1, 1, 2, 3) THEN 9999 ELSE -1 END AS INDICADORA_E00, 
 CASE WHEN CD2010ADOMI.CODV0209 = 1 THEN 1 WHEN CD2010ADOMI.CODV0209 = 2 THEN 6 WHEN CD2010ADOMI.CODV0209 = 3 THEN 11 ELSE -1 END AS INDICADORA_E01, 
 CASE WHEN CD2010ADOMI.CODV0209 = 1 AND CD2010ADOMI.CODV0208 = 1 THEN 2 WHEN CD2010ADOMI.CODV0208 = 2 AND CD2010ADOMI.CODV0209 = 1 THEN 3 WHEN CD2010ADOMI.CODV0209 = 1 AND CD2010ADOMI.CODV0208 = 3 THEN 4 WHEN CD2010ADOMI.CODV0209 = 1 AND CD2010ADOMI.CODV0208 IN (4, 5, 6, 7, 8, 9, 10) THEN 5 WHEN CD2010ADOMI.CODV0209 = 2 AND CD2010ADOMI.CODV0208 = 1 THEN 7 WHEN CD2010ADOMI.CODV0209 = 2 AND CD2010ADOMI.CODV0208 = 2 THEN 8 WHEN CD2010ADOMI.CODV0209 = 2 AND CD2010ADOMI.CODV0208 = 3 THEN 9 WHEN CD2010ADOMI.CODV0209 = 2 AND CD2010ADOMI.CODV0208 IN (4, 5, 6, 7, 8, 9, 10) THEN 10 ELSE -1 END AS INDICADORA_E02, 
CD2010ADOMI.PESODOMI, 
CD2010ADOMI.V6529, 
CD2010ADOMI.CODV4001, 
CD2010ADOMI.V0401, 
CD2010ADOMI.CODPAIS AS INDICADORA_GEOG1, 
CD2010ADOMI.CODANOPESQ AS INDICADORA_TEMPORAL
 FROM IBGE.CD2010ADOMI
 WHERE CD2010ADOMI.CODANOPESQ = 2010 AND CD2010ADOMI.CODV4001 = 1 AND CD2010ADOMI.V6529 > 0 AND CD2010ADOMI.V6529 <= 9999999
);

---------------------------------------------------------------------


SELECT A.INDICADORA_GEOG1, 
A.INDICADORA_A00, 
A.INDICADORA_A01, 
A.INDICADORA_B00, 
A.INDICADORA_B01, 
A.INDICADORA_C00, 
A.INDICADORA_C01, 
A.INDICADORA_D00, 
A.INDICADORA_D01, 
A.INDICADORA_E00, 
A.INDICADORA_E01, 
A.INDICADORA_E02,
SUM(PESODOMI) AS V884,
SUM(V6529 * A.PESODOMI) / SUM(PESODOMI) AS V878, 
SUM(V0401 * A.PESODOMI) AS V1883
 FROM ( 
RT_CD2010_T3525_12230b ) A 
 GROUP BY 
A.INDICADORA_GEOG1,
 GROUPING SETS ( 
(A.INDICADORA_A00, A.INDICADORA_B00, A.INDICADORA_C00, A.INDICADORA_D00, A.INDICADORA_E00), 
(A.INDICADORA_A00, A.INDICADORA_B00, A.INDICADORA_C00, A.INDICADORA_D00, A.INDICADORA_E01), 
(A.INDICADORA_A00, A.INDICADORA_B00, A.INDICADORA_C00, A.INDICADORA_D00, A.INDICADORA_E02), 
(A.INDICADORA_A00, A.INDICADORA_B00, A.INDICADORA_C00, A.INDICADORA_D01, A.INDICADORA_E00), 
(A.INDICADORA_A00, A.INDICADORA_B00, A.INDICADORA_C00, A.INDICADORA_D01, A.INDICADORA_E01), 
(A.INDICADORA_A00, A.INDICADORA_B00, A.INDICADORA_C00, A.INDICADORA_D01, A.INDICADORA_E02), 
(A.INDICADORA_A00, A.INDICADORA_B00, A.INDICADORA_C01, A.INDICADORA_D00, A.INDICADORA_E00), 
(A.INDICADORA_A00, A.INDICADORA_B00, A.INDICADORA_C01, A.INDICADORA_D00, A.INDICADORA_E01), 
(A.INDICADORA_A00, A.INDICADORA_B00, A.INDICADORA_C01, A.INDICADORA_D00, A.INDICADORA_E02), 
(A.INDICADORA_A00, A.INDICADORA_B00, A.INDICADORA_C01, A.INDICADORA_D01, A.INDICADORA_E00), 
(A.INDICADORA_A00, A.INDICADORA_B00, A.INDICADORA_C01, A.INDICADORA_D01, A.INDICADORA_E01), 
(A.INDICADORA_A00, A.INDICADORA_B00, A.INDICADORA_C01, A.INDICADORA_D01, A.INDICADORA_E02), 
(A.INDICADORA_A00, A.INDICADORA_B01, A.INDICADORA_C00, A.INDICADORA_D00, A.INDICADORA_E00), 
(A.INDICADORA_A00, A.INDICADORA_B01, A.INDICADORA_C00, A.INDICADORA_D00, A.INDICADORA_E01), 
(A.INDICADORA_A00, A.INDICADORA_B01, A.INDICADORA_C00, A.INDICADORA_D00, A.INDICADORA_E02), 
(A.INDICADORA_A00, A.INDICADORA_B01, A.INDICADORA_C00, A.INDICADORA_D01, A.INDICADORA_E00), 
(A.INDICADORA_A00, A.INDICADORA_B01, A.INDICADORA_C00, A.INDICADORA_D01, A.INDICADORA_E01), 
(A.INDICADORA_A00, A.INDICADORA_B01, A.INDICADORA_C00, A.INDICADORA_D01, A.INDICADORA_E02), 
(A.INDICADORA_A00, A.INDICADORA_B01, A.INDICADORA_C01, A.INDICADORA_D00, A.INDICADORA_E00), 
(A.INDICADORA_A00, A.INDICADORA_B01, A.INDICADORA_C01, A.INDICADORA_D00, A.INDICADORA_E01), 
(A.INDICADORA_A00, A.INDICADORA_B01, A.INDICADORA_C01, A.INDICADORA_D00, A.INDICADORA_E02), 
(A.INDICADORA_A00, A.INDICADORA_B01, A.INDICADORA_C01, A.INDICADORA_D01, A.INDICADORA_E00), 
(A.INDICADORA_A00, A.INDICADORA_B01, A.INDICADORA_C01, A.INDICADORA_D01, A.INDICADORA_E01), 
(A.INDICADORA_A00, A.INDICADORA_B01, A.INDICADORA_C01, A.INDICADORA_D01, A.INDICADORA_E02), 
(A.INDICADORA_A01, A.INDICADORA_B00, A.INDICADORA_C00, A.INDICADORA_D00, A.INDICADORA_E00), 
(A.INDICADORA_A01, A.INDICADORA_B00, A.INDICADORA_C00, A.INDICADORA_D00, A.INDICADORA_E01), 
(A.INDICADORA_A01, A.INDICADORA_B00, A.INDICADORA_C00, A.INDICADORA_D00, A.INDICADORA_E02), 
(A.INDICADORA_A01, A.INDICADORA_B00, A.INDICADORA_C00, A.INDICADORA_D01, A.INDICADORA_E00), 
(A.INDICADORA_A01, A.INDICADORA_B00, A.INDICADORA_C00, A.INDICADORA_D01, A.INDICADORA_E01), 
(A.INDICADORA_A01, A.INDICADORA_B00, A.INDICADORA_C00, A.INDICADORA_D01, A.INDICADORA_E02), 
(A.INDICADORA_A01, A.INDICADORA_B00, A.INDICADORA_C01, A.INDICADORA_D00, A.INDICADORA_E00), 
(A.INDICADORA_A01, A.INDICADORA_B00, A.INDICADORA_C01, A.INDICADORA_D00, A.INDICADORA_E01), 
(A.INDICADORA_A01, A.INDICADORA_B00, A.INDICADORA_C01, A.INDICADORA_D00, A.INDICADORA_E02), 
(A.INDICADORA_A01, A.INDICADORA_B00, A.INDICADORA_C01, A.INDICADORA_D01, A.INDICADORA_E00), 
(A.INDICADORA_A01, A.INDICADORA_B00, A.INDICADORA_C01, A.INDICADORA_D01, A.INDICADORA_E01), 
(A.INDICADORA_A01, A.INDICADORA_B00, A.INDICADORA_C01, A.INDICADORA_D01, A.INDICADORA_E02), 
(A.INDICADORA_A01, A.INDICADORA_B01, A.INDICADORA_C00, A.INDICADORA_D00, A.INDICADORA_E00), 
(A.INDICADORA_A01, A.INDICADORA_B01, A.INDICADORA_C00, A.INDICADORA_D00, A.INDICADORA_E01), 
(A.INDICADORA_A01, A.INDICADORA_B01, A.INDICADORA_C00, A.INDICADORA_D00, A.INDICADORA_E02), 
(A.INDICADORA_A01, A.INDICADORA_B01, A.INDICADORA_C00, A.INDICADORA_D01, A.INDICADORA_E00), 
(A.INDICADORA_A01, A.INDICADORA_B01, A.INDICADORA_C00, A.INDICADORA_D01, A.INDICADORA_E01), 
(A.INDICADORA_A01, A.INDICADORA_B01, A.INDICADORA_C00, A.INDICADORA_D01, A.INDICADORA_E02), 
(A.INDICADORA_A01, A.INDICADORA_B01, A.INDICADORA_C01, A.INDICADORA_D00, A.INDICADORA_E00), 
(A.INDICADORA_A01, A.INDICADORA_B01, A.INDICADORA_C01, A.INDICADORA_D00, A.INDICADORA_E01), 
(A.INDICADORA_A01, A.INDICADORA_B01, A.INDICADORA_C01, A.INDICADORA_D00, A.INDICADORA_E02), 
(A.INDICADORA_A01, A.INDICADORA_B01, A.INDICADORA_C01, A.INDICADORA_D01, A.INDICADORA_E00), 
(A.INDICADORA_A01, A.INDICADORA_B01, A.INDICADORA_C01, A.INDICADORA_D01, A.INDICADORA_E01), 
(A.INDICADORA_A01, A.INDICADORA_B01, A.INDICADORA_C01, A.INDICADORA_D01, A.INDICADORA_E02) ) 
 HAVING ( 
( NVL(A.INDICADORA_A00, -1) <> -1 OR NVL(A.INDICADORA_A01, -1) <> -1 ) AND
( NVL(A.INDICADORA_B00, -1) <> -1 OR NVL(A.INDICADORA_B01, -1) <> -1 ) AND
( NVL(A.INDICADORA_C00, -1) <> -1 OR NVL(A.INDICADORA_C01, -1) <> -1 ) AND
( NVL(A.INDICADORA_D00, -1) <> -1 OR NVL(A.INDICADORA_D01, -1) <> -1 ) AND
( NVL(A.INDICADORA_E00, -1) <> -1 OR NVL(A.INDICADORA_E01, -1) <> -1 OR NVL(A.INDICADORA_E02, -1) <> -1 ) ) 
;
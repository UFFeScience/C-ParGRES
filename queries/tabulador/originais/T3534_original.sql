CREATE TABLE RT_CD2010_T3534_12232b AS (
 SELECT  CASE WHEN CD2010ADOMI.CODV1006 IN (-1, 1, 2) THEN 9999 ELSE -1 END AS INDICADORA_A00, 
 CASE WHEN CD2010ADOMI.CODV1006 = 1 THEN 1 WHEN CD2010ADOMI.CODV1006 = 2 THEN 2 ELSE -1 END AS INDICADORA_A01, 
 CASE WHEN CD2010ADOMI.CODV0203 IN (-1, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11) THEN 9999 ELSE -1 END AS INDICADORA_B00, 
 CASE WHEN CD2010ADOMI.CODV0203 = 1 THEN 1 WHEN CD2010ADOMI.CODV0203 = 2 THEN 2 WHEN CD2010ADOMI.CODV0203 = 3 THEN 3 WHEN CD2010ADOMI.CODV0203 = 4 THEN 4 WHEN CD2010ADOMI.CODV0203 = 5 THEN 5 WHEN CD2010ADOMI.CODV0203 = 6 THEN 6 WHEN CD2010ADOMI.CODV0203 = 7 THEN 7 WHEN CD2010ADOMI.CODV0203 = 8 THEN 8 WHEN CD2010ADOMI.CODV0203 = 9 THEN 9 WHEN CD2010ADOMI.CODV0203 IN (10, 11) THEN 10 ELSE -1 END AS INDICADORA_B01, 
 CASE WHEN CD2010ADOMI.CODV4001 = 1 THEN 9999 ELSE -1 END AS INDICADORA_C00, 
 CASE WHEN CD2010ADOMI.CODV0213 = 1 THEN 1 ELSE -1 END AS INDICADORA_C01, 
 CASE WHEN CD2010ADOMI.CODV0214 = 1 THEN 2 ELSE -1 END AS INDICADORA_C02, 
 CASE WHEN CD2010ADOMI.CODV0215 = 1 THEN 3 ELSE -1 END AS INDICADORA_C03, 
 CASE WHEN CD2010ADOMI.CODV0216 = 1 THEN 4 ELSE -1 END AS INDICADORA_C04, 
 CASE WHEN CD2010ADOMI.CODV0217 = 1 THEN 5 ELSE -1 END AS INDICADORA_C05, 
 CASE WHEN CD2010ADOMI.CODV0218 = 1 THEN 6 ELSE -1 END AS INDICADORA_C06, 
 CASE WHEN CD2010ADOMI.CODV0219 = 1 THEN 7 ELSE -1 END AS INDICADORA_C07, 
 CASE WHEN CD2010ADOMI.CODV0221 = 1 THEN 9 ELSE -1 END AS INDICADORA_C08, 
 CASE WHEN CD2010ADOMI.CODV0222 = 1 THEN 10 ELSE -1 END AS INDICADORA_C09, 
 CASE WHEN CD2010ADOMI.CODV0220 = 1 THEN 8 ELSE -1 END AS INDICADORA_C10, 
CD2010ADOMI.PESODOMI,
CD2010ADOMI.V6529, 
CD2010ADOMI.CODV4001, 
CD2010ADOMI.V0401, 
CD2010ADOMI.CODPAIS AS INDICADORA_GEOG1, 
CD2010ADOMI.CODANOPESQ AS INDICADORA_TEMPORAL
 FROM IBGE.CD2010ADOMI
 WHERE CD2010ADOMI.CODANOPESQ = 2010 AND CD2010ADOMI.CODV4001 = 1 AND CD2010ADOMI.V6529 > 0 AND CD2010ADOMI.V6529 <= 9999999
);


---------------------------------------------------------------------


SELECT A.INDICADORA_GEOG1, 
A.INDICADORA_A00, 
A.INDICADORA_A01, 
A.INDICADORA_B00, 
A.INDICADORA_B01, 
A.INDICADORA_C00, 
A.INDICADORA_C01, 
A.INDICADORA_C02, 
A.INDICADORA_C03, 
A.INDICADORA_C04, 
A.INDICADORA_C05, 
A.INDICADORA_C06, 
A.INDICADORA_C07, 
A.INDICADORA_C08, 
A.INDICADORA_C09, 
A.INDICADORA_C10,
SUM(PESODOMI) AS V884, 
SUM(A.V6529 * A.PESODOMI) / SUM(A.PESODOMI) AS V878, 
SUM(A.V0401 * A.PESODOMI) AS V1883
 FROM ( 
RT_CD2010_T3534_12232b ) A 
 GROUP BY 
A.INDICADORA_GEOG1,
 GROUPING SETS ( 
(A.INDICADORA_A00, A.INDICADORA_B00, A.INDICADORA_C00), 
(A.INDICADORA_A00, A.INDICADORA_B00, A.INDICADORA_C01), 
(A.INDICADORA_A00, A.INDICADORA_B00, A.INDICADORA_C02), 
(A.INDICADORA_A00, A.INDICADORA_B00, A.INDICADORA_C03), 
(A.INDICADORA_A00, A.INDICADORA_B00, A.INDICADORA_C04), 
(A.INDICADORA_A00, A.INDICADORA_B00, A.INDICADORA_C05), 
(A.INDICADORA_A00, A.INDICADORA_B00, A.INDICADORA_C06), 
(A.INDICADORA_A00, A.INDICADORA_B00, A.INDICADORA_C07), 
(A.INDICADORA_A00, A.INDICADORA_B00, A.INDICADORA_C08), 
(A.INDICADORA_A00, A.INDICADORA_B00, A.INDICADORA_C09), 
(A.INDICADORA_A00, A.INDICADORA_B00, A.INDICADORA_C10), 
(A.INDICADORA_A00, A.INDICADORA_B01, A.INDICADORA_C00), 
(A.INDICADORA_A00, A.INDICADORA_B01, A.INDICADORA_C01), 
(A.INDICADORA_A00, A.INDICADORA_B01, A.INDICADORA_C02), 
(A.INDICADORA_A00, A.INDICADORA_B01, A.INDICADORA_C03), 
(A.INDICADORA_A00, A.INDICADORA_B01, A.INDICADORA_C04), 
(A.INDICADORA_A00, A.INDICADORA_B01, A.INDICADORA_C05), 
(A.INDICADORA_A00, A.INDICADORA_B01, A.INDICADORA_C06), 
(A.INDICADORA_A00, A.INDICADORA_B01, A.INDICADORA_C07), 
(A.INDICADORA_A00, A.INDICADORA_B01, A.INDICADORA_C08), 
(A.INDICADORA_A00, A.INDICADORA_B01, A.INDICADORA_C09), 
(A.INDICADORA_A00, A.INDICADORA_B01, A.INDICADORA_C10), 
(A.INDICADORA_A01, A.INDICADORA_B00, A.INDICADORA_C00), 
(A.INDICADORA_A01, A.INDICADORA_B00, A.INDICADORA_C01), 
(A.INDICADORA_A01, A.INDICADORA_B00, A.INDICADORA_C02), 
(A.INDICADORA_A01, A.INDICADORA_B00, A.INDICADORA_C03), 
(A.INDICADORA_A01, A.INDICADORA_B00, A.INDICADORA_C04), 
(A.INDICADORA_A01, A.INDICADORA_B00, A.INDICADORA_C05), 
(A.INDICADORA_A01, A.INDICADORA_B00, A.INDICADORA_C06), 
(A.INDICADORA_A01, A.INDICADORA_B00, A.INDICADORA_C07), 
(A.INDICADORA_A01, A.INDICADORA_B00, A.INDICADORA_C08), 
(A.INDICADORA_A01, A.INDICADORA_B00, A.INDICADORA_C09), 
(A.INDICADORA_A01, A.INDICADORA_B00, A.INDICADORA_C10), 
(A.INDICADORA_A01, A.INDICADORA_B01, A.INDICADORA_C00), 
(A.INDICADORA_A01, A.INDICADORA_B01, A.INDICADORA_C01), 
(A.INDICADORA_A01, A.INDICADORA_B01, A.INDICADORA_C02), 
(A.INDICADORA_A01, A.INDICADORA_B01, A.INDICADORA_C03), 
(A.INDICADORA_A01, A.INDICADORA_B01, A.INDICADORA_C04), 
(A.INDICADORA_A01, A.INDICADORA_B01, A.INDICADORA_C05), 
(A.INDICADORA_A01, A.INDICADORA_B01, A.INDICADORA_C06), 
(A.INDICADORA_A01, A.INDICADORA_B01, A.INDICADORA_C07), 
(A.INDICADORA_A01, A.INDICADORA_B01, A.INDICADORA_C08), 
(A.INDICADORA_A01, A.INDICADORA_B01, A.INDICADORA_C09), 
(A.INDICADORA_A01, A.INDICADORA_B01, A.INDICADORA_C10) ) 
 HAVING ( 
( NVL(A.INDICADORA_A00, -1) <> -1 OR NVL(A.INDICADORA_A01, -1) <> -1 ) AND
( NVL(A.INDICADORA_B00, -1) <> -1 OR NVL(A.INDICADORA_B01, -1) <> -1 ) AND
( NVL(A.INDICADORA_C00, -1) <> -1 OR NVL(A.INDICADORA_C01, -1) <> -1 OR NVL(A.INDICADORA_C02, -1) <> -1 OR NVL(A.INDICADORA_C03, -1) <> -1 OR NVL(A.INDICADORA_C04, -1) <> -1 OR NVL(A.INDICADORA_C05, -1) <> -1 OR NVL(A.INDICADORA_C06, -1) <> -1 OR NVL(A.INDICADORA_C07, -1) <> -1 OR NVL(A.INDICADORA_C08, -1) <> -1 OR NVL(A.INDICADORA_C09, -1) <> -1 OR NVL(A.INDICADORA_C10, -1) <> -1 ) ) 
;